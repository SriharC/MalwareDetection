import yara

try:
    rules = yara.compile(source='rule MalwareRules {meta: description = "Detect Pikabot, Amadey, and RedLineStealer malwares based on SHA-256 hash" strings: $hash1 = {96de70ca69f2455e96cefdfc80d1b033fa9d6be71c18df9b5e6c417e04456ac3} $hash2 = {ad8eaf453e7529fd470fe12c15a74ac938cd358c2d2787f6c524ea52283bbc9c} $hash3 = {229e859dda6cc0bc99a395824f4524693bdd0292b4b9c55d06b4fa38279b3ea2} condition: any of ($hash*) }')
    sample_path = input("Enter a path to the code sample: ")

    def code_scan(sample_path, rules):
        with open(sample_path, 'r') as file:
            code_sample = file.read()

        matches = rules.match(date=code_sample)

        if matches:
            print(" Following malware has been detected in the code: Pikabot, Amadey, or RedLineStealer")
        else:
            print("No malware detected in code")
except yara.Error as e:
    print(f"Error while compiling YARA rules: {e}")
